<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.6.0"><title>HI226/HI229 User Guide - HiPNUC Documentation</title><link rel=stylesheet href=../../assets/stylesheets/application.1b62728e.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../assets/javascripts/modernizr.268332fc.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css></head> <body dir=ltr data-md-color-primary=black data-md-color-accent=black> <svg class=md-svg> <defs> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#hi226hi229-user-guide tabindex=1 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=http://www.hipnuc.com/ title="HiPNUC Documentation" class="md-header-nav__button md-logo"> <i class=md-icon>home</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> HiPNUC Documentation </span> <span class=md-header-nav__topic> HI226/HI229 User Guide </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=../../index.html title="HiPNUC Documentation" class="md-nav__button md-logo"> <i class=md-icon>home</i> </a> HiPNUC Documentation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Introduction class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> Hi221 </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Hi221 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../hi221/hi221um_en/ title="HI221/HI221GW User Guide" class=md-nav__link> HI221/HI221GW User Guide </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3 checked> <label class=md-nav__link for=nav-3> Hi229 </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Hi229 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> HI226/HI229 User Guide </label> <a href=./ title="HI226/HI229 User Guide" class="md-nav__link md-nav__link--active"> HI226/HI229 User Guide </a> <nav class="md-nav md-nav--secondary"> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#features class=md-nav__link> Features </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#on-board-sensors class=md-nav__link> On-board sensors </a> </li> <li class=md-nav__item> <a href=#data-process class=md-nav__link> Data process </a> </li> <li class=md-nav__item> <a href=#communication-interface-and-power-supply-of-hi226-and-hi229 class=md-nav__link> Communication interface and power supply of HI226 and HI229 </a> </li> <li class=md-nav__item> <a href=#others class=md-nav__link> Others </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hardware-specifications class=md-nav__link> Hardware Specifications </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifications class=md-nav__link> Specifications </a> </li> <li class=md-nav__item> <a href=#size class=md-nav__link> Size </a> </li> <li class=md-nav__item> <a href=#pin-definition class=md-nav__link> Pin Definition </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance class=md-nav__link> Performance </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-accuracy-of-attitude class=md-nav__link> Output accuracy of attitude </a> </li> <li class=md-nav__item> <a href=#gyroscope class=md-nav__link> Gyroscope </a> </li> <li class=md-nav__item> <a href=#accelerometer class=md-nav__link> Accelerometer </a> </li> <li class=md-nav__item> <a href=#magnetometer class=md-nav__link> Magnetometer </a> </li> <li class=md-nav__item> <a href=#data-interface-specifications class=md-nav__link> Data interface specifications </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-fusion-and-calibration-algorithm class=md-nav__link> Data Fusion and Calibration Algorithm </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calibration-of-gyroscope class=md-nav__link> Calibration of gyroscope </a> </li> <li class=md-nav__item> <a href=#magnetic-interference-distortion-rejection-and-magnetic-calibration class=md-nav__link> Magnetic interference, Distortion rejection and magnetic calibration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type-of-magnetic-interference class=md-nav__link> Type of magnetic interference </a> </li> <li class=md-nav__item> <a href=#operation-mode class=md-nav__link> Operation mode </a> </li> <li class=md-nav__item> <a href=#geomagnetic-calibration class=md-nav__link> Geomagnetic Calibration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hardware-installation-and-welding class=md-nav__link> Hardware Installation and Welding </a> </li> <li class=md-nav__item> <a href=#definition-of-reference-frame class=md-nav__link> Definition of Reference Frame </a> </li> <li class=md-nav__item> <a href=#application-guide class=md-nav__link> Application Guide </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#connection-between-module-and-pc class=md-nav__link> Connection Between Module and PC </a> </li> <li class=md-nav__item> <a href=#connection-between-module-and-micro-controller class=md-nav__link> Connection Between Module and Micro Controller </a> </li> <li class=md-nav__item> <a href=#notice class=md-nav__link> Notice </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#protocol-of-serial-communication class=md-nav__link> Protocol of Serial Communication </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#format-of-a-packet class=md-nav__link> Format of a Packet </a> </li> <li class=md-nav__item> <a href=#factory-default-register class=md-nav__link> Factory Default Register </a> </li> <li class=md-nav__item> <a href=#example-of-data-structure-in-a-frame class=md-nav__link> Example of Data Structure in a Frame </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#general-at-command class=md-nav__link> General AT Command </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#atid class=md-nav__link> AT+ID </a> </li> <li class=md-nav__item> <a href=#atgwid class=md-nav__link> AT+GWID </a> </li> <li class=md-nav__item> <a href=#aturfr class=md-nav__link> AT+URFR </a> </li> <li class=md-nav__item> <a href=#atinfo class=md-nav__link> AT+INFO </a> </li> <li class=md-nav__item> <a href=#atodr class=md-nav__link> AT+ODR </a> </li> <li class=md-nav__item> <a href=#atbaud class=md-nav__link> AT+BAUD </a> </li> <li class=md-nav__item> <a href=#ateout class=md-nav__link> AT+EOUT </a> </li> <li class=md-nav__item> <a href=#atrst class=md-nav__link> AT+RST </a> </li> <li class=md-nav__item> <a href=#attrg class=md-nav__link> AT+TRG </a> </li> <li class=md-nav__item> <a href=#atsetpel class=md-nav__link> AT+SETPEL </a> </li> <li class=md-nav__item> <a href=#atmode class=md-nav__link> AT+MODE </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-a-evaluation-board class=md-nav__link> Appendix A - Evaluation Board </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview: </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> Getting started: </a> </li> <li class=md-nav__item> <a href=#remove-the-product-from-the-evaluation-board class=md-nav__link> Remove the product from the evaluation board: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-b-conversion-between-quaternion-and-euler-angles class=md-nav__link> Appendix B - Conversion Between Quaternion and Euler Angles </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-conceptions-of-quaternion class=md-nav__link> Basic conceptions of quaternion </a> </li> <li class=md-nav__item> <a href=#conversion-between-quaternions-rotation-matrices-and-euler-angles class=md-nav__link> Conversion between quaternions, rotation matrices, and Euler angles </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quaternion-rotation-matrix class=md-nav__link> Quaternion -&gt; Rotation matrix </a> </li> <li class=md-nav__item> <a href=#quaternion-euler-angles class=md-nav__link> Quaternion -&gt; Euler angles </a> </li> <li class=md-nav__item> <a href=#euler-angles-quaternion class=md-nav__link> Euler angles -&gt; Quaternion </a> </li> <li class=md-nav__item> <a href=#euler-angles-rotation-matrix-n-b class=md-nav__link> Euler angles -&gt; Rotation matrix (n-&gt;b) </a> </li> <li class=md-nav__item> <a href=#rotation-matrix-n-b-euler-angles class=md-nav__link> Rotation matrix (n-&gt;b) -&gt; Euler angles </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-c-firmware-upgrade-and-factory-reset class=md-nav__link> Appendix C - Firmware Upgrade and Factory Reset </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#introduction class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=#features class=md-nav__link> Features </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#on-board-sensors class=md-nav__link> On-board sensors </a> </li> <li class=md-nav__item> <a href=#data-process class=md-nav__link> Data process </a> </li> <li class=md-nav__item> <a href=#communication-interface-and-power-supply-of-hi226-and-hi229 class=md-nav__link> Communication interface and power supply of HI226 and HI229 </a> </li> <li class=md-nav__item> <a href=#others class=md-nav__link> Others </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hardware-specifications class=md-nav__link> Hardware Specifications </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#specifications class=md-nav__link> Specifications </a> </li> <li class=md-nav__item> <a href=#size class=md-nav__link> Size </a> </li> <li class=md-nav__item> <a href=#pin-definition class=md-nav__link> Pin Definition </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance class=md-nav__link> Performance </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#output-accuracy-of-attitude class=md-nav__link> Output accuracy of attitude </a> </li> <li class=md-nav__item> <a href=#gyroscope class=md-nav__link> Gyroscope </a> </li> <li class=md-nav__item> <a href=#accelerometer class=md-nav__link> Accelerometer </a> </li> <li class=md-nav__item> <a href=#magnetometer class=md-nav__link> Magnetometer </a> </li> <li class=md-nav__item> <a href=#data-interface-specifications class=md-nav__link> Data interface specifications </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-fusion-and-calibration-algorithm class=md-nav__link> Data Fusion and Calibration Algorithm </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#calibration-of-gyroscope class=md-nav__link> Calibration of gyroscope </a> </li> <li class=md-nav__item> <a href=#magnetic-interference-distortion-rejection-and-magnetic-calibration class=md-nav__link> Magnetic interference, Distortion rejection and magnetic calibration </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#type-of-magnetic-interference class=md-nav__link> Type of magnetic interference </a> </li> <li class=md-nav__item> <a href=#operation-mode class=md-nav__link> Operation mode </a> </li> <li class=md-nav__item> <a href=#geomagnetic-calibration class=md-nav__link> Geomagnetic Calibration </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#hardware-installation-and-welding class=md-nav__link> Hardware Installation and Welding </a> </li> <li class=md-nav__item> <a href=#definition-of-reference-frame class=md-nav__link> Definition of Reference Frame </a> </li> <li class=md-nav__item> <a href=#application-guide class=md-nav__link> Application Guide </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#connection-between-module-and-pc class=md-nav__link> Connection Between Module and PC </a> </li> <li class=md-nav__item> <a href=#connection-between-module-and-micro-controller class=md-nav__link> Connection Between Module and Micro Controller </a> </li> <li class=md-nav__item> <a href=#notice class=md-nav__link> Notice </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#protocol-of-serial-communication class=md-nav__link> Protocol of Serial Communication </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#format-of-a-packet class=md-nav__link> Format of a Packet </a> </li> <li class=md-nav__item> <a href=#factory-default-register class=md-nav__link> Factory Default Register </a> </li> <li class=md-nav__item> <a href=#example-of-data-structure-in-a-frame class=md-nav__link> Example of Data Structure in a Frame </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#general-at-command class=md-nav__link> General AT Command </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#atid class=md-nav__link> AT+ID </a> </li> <li class=md-nav__item> <a href=#atgwid class=md-nav__link> AT+GWID </a> </li> <li class=md-nav__item> <a href=#aturfr class=md-nav__link> AT+URFR </a> </li> <li class=md-nav__item> <a href=#atinfo class=md-nav__link> AT+INFO </a> </li> <li class=md-nav__item> <a href=#atodr class=md-nav__link> AT+ODR </a> </li> <li class=md-nav__item> <a href=#atbaud class=md-nav__link> AT+BAUD </a> </li> <li class=md-nav__item> <a href=#ateout class=md-nav__link> AT+EOUT </a> </li> <li class=md-nav__item> <a href=#atrst class=md-nav__link> AT+RST </a> </li> <li class=md-nav__item> <a href=#attrg class=md-nav__link> AT+TRG </a> </li> <li class=md-nav__item> <a href=#atsetpel class=md-nav__link> AT+SETPEL </a> </li> <li class=md-nav__item> <a href=#atmode class=md-nav__link> AT+MODE </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-a-evaluation-board class=md-nav__link> Appendix A - Evaluation Board </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#overview class=md-nav__link> Overview: </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> Getting started: </a> </li> <li class=md-nav__item> <a href=#remove-the-product-from-the-evaluation-board class=md-nav__link> Remove the product from the evaluation board: </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-b-conversion-between-quaternion-and-euler-angles class=md-nav__link> Appendix B - Conversion Between Quaternion and Euler Angles </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#basic-conceptions-of-quaternion class=md-nav__link> Basic conceptions of quaternion </a> </li> <li class=md-nav__item> <a href=#conversion-between-quaternions-rotation-matrices-and-euler-angles class=md-nav__link> Conversion between quaternions, rotation matrices, and Euler angles </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quaternion-rotation-matrix class=md-nav__link> Quaternion -&gt; Rotation matrix </a> </li> <li class=md-nav__item> <a href=#quaternion-euler-angles class=md-nav__link> Quaternion -&gt; Euler angles </a> </li> <li class=md-nav__item> <a href=#euler-angles-quaternion class=md-nav__link> Euler angles -&gt; Quaternion </a> </li> <li class=md-nav__item> <a href=#euler-angles-rotation-matrix-n-b class=md-nav__link> Euler angles -&gt; Rotation matrix (n-&gt;b) </a> </li> <li class=md-nav__item> <a href=#rotation-matrix-n-b-euler-angles class=md-nav__link> Rotation matrix (n-&gt;b) -&gt; Euler angles </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#appendix-c-firmware-upgrade-and-factory-reset class=md-nav__link> Appendix C - Firmware Upgrade and Factory Reset </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=hi226hi229-user-guide>HI226/HI229 User Guide</h1> <p><p style="text-align: right;">IMU/VRU/AHRS attitude measuring module, Rev A1</p> <p><img alt src=../figures/front_image.png></p> <div style="page-break-after: always;"></div> <div class=toc> <ul> <li><a href=#hi226hi229-user-guide>HI226/HI229 User Guide</a><ul> <li><a href=#introduction>Introduction</a></li> <li><a href=#features>Features</a><ul> <li><a href=#on-board-sensors>On-board sensors</a></li> <li><a href=#data-process>Data process</a></li> <li><a href=#communication-interface-and-power-supply-of-hi226-and-hi229>Communication interface and power supply of HI226 and HI229</a></li> <li><a href=#others>Others</a></li> </ul> </li> <li><a href=#hardware-specifications>Hardware Specifications</a><ul> <li><a href=#specifications>Specifications</a></li> <li><a href=#size>Size</a></li> <li><a href=#pin-definition>Pin Definition</a></li> </ul> </li> <li><a href=#performance>Performance</a><ul> <li><a href=#output-accuracy-of-attitude>Output accuracy of attitude</a></li> <li><a href=#gyroscope>Gyroscope</a></li> <li><a href=#accelerometer>Accelerometer</a></li> <li><a href=#magnetometer>Magnetometer</a></li> <li><a href=#data-interface-specifications>Data interface specifications</a></li> </ul> </li> <li><a href=#data-fusion-and-calibration-algorithm>Data Fusion and Calibration Algorithm</a><ul> <li><a href=#calibration-of-gyroscope>Calibration of gyroscope</a></li> <li><a href=#magnetic-interference-distortion-rejection-and-magnetic-calibration>Magnetic interference, Distortion rejection and magnetic calibration</a><ul> <li><a href=#type-of-magnetic-interference>Type of magnetic interference</a></li> <li><a href=#operation-mode>Operation mode</a></li> <li><a href=#geomagnetic-calibration>Geomagnetic Calibration</a></li> </ul> </li> </ul> </li> <li><a href=#hardware-installation-and-welding>Hardware Installation and Welding</a></li> <li><a href=#definition-of-reference-frame>Definition of Reference Frame</a></li> <li><a href=#application-guide>Application Guide</a><ul> <li><a href=#connection-between-module-and-pc>Connection Between Module and PC</a></li> <li><a href=#connection-between-module-and-micro-controller>Connection Between Module and Micro Controller</a></li> <li><a href=#notice>Notice</a></li> </ul> </li> <li><a href=#protocol-of-serial-communication>Protocol of Serial Communication</a><ul> <li><a href=#format-of-a-packet>Format of a Packet</a></li> <li><a href=#factory-default-register>Factory Default Register</a></li> <li><a href=#example-of-data-structure-in-a-frame>Example of Data Structure in a Frame</a></li> </ul> </li> <li><a href=#general-at-command>General AT Command</a><ul> <li><a href=#atid>AT+ID</a></li> <li><a href=#atgwid>AT+GWID</a></li> <li><a href=#aturfr>AT+URFR</a></li> <li><a href=#atinfo>AT+INFO</a></li> <li><a href=#atodr>AT+ODR</a></li> <li><a href=#atbaud>AT+BAUD</a></li> <li><a href=#ateout>AT+EOUT</a></li> <li><a href=#atrst>AT+RST</a></li> <li><a href=#attrg>AT+TRG</a></li> <li><a href=#atsetpel>AT+SETPEL</a></li> <li><a href=#atmode>AT+MODE</a></li> </ul> </li> <li><a href=#appendix-a-evaluation-board>Appendix A - Evaluation Board</a><ul> <li><a href=#overview>Overview:</a></li> <li><a href=#getting-started>Getting started:</a></li> <li><a href=#remove-the-product-from-the-evaluation-board>Remove the product from the evaluation board:</a></li> </ul> </li> <li><a href=#appendix-b-conversion-between-quaternion-and-euler-angles>Appendix B - Conversion Between Quaternion and Euler Angles</a><ul> <li><a href=#basic-conceptions-of-quaternion>Basic conceptions of quaternion</a></li> <li><a href=#conversion-between-quaternions-rotation-matrices-and-euler-angles>Conversion between quaternions, rotation matrices, and Euler angles</a><ul> <li><a href=#quaternion-rotation-matrix>Quaternion -&gt; Rotation matrix</a></li> <li><a href=#quaternion-euler-angles>Quaternion -&gt; Euler angles</a></li> <li><a href=#euler-angles-quaternion>Euler angles -&gt; Quaternion</a></li> <li><a href=#euler-angles-rotation-matrix-n-b>Euler angles -&gt; Rotation matrix (n-&gt;b)</a></li> <li><a href=#rotation-matrix-n-b-euler-angles>Rotation matrix (n-&gt;b) -&gt; Euler angles</a></li> </ul> </li> </ul> </li> <li><a href=#appendix-c-firmware-upgrade-and-factory-reset>Appendix C - Firmware Upgrade and Factory Reset</a></li> </ul> </li> </ul> </div> <div style="page-break-after: always;"></div> <h2 id=introduction>Introduction</h2> <p>HI226 is a miniature inertial measurement unit (IMU) system launched by HIPNUC. This module features low cost, high performance, small size, and low latency. This module integrates a 3-axis accelerometer, a 3-axis gyroscope and a MCU, and can output accurate 3D attitude data which is calibrated by factory, including relative heading, pitch, and roll angles (without absolute reference). It can also output raw sensor data. </p> <p><img alt src=../figures/HI226.png></p> <p>Typical application:</p> <ul> <li>Sweeping robot / Indoor robot positioning/ Mouse / Game controller</li> </ul> <p>Different from HI226, HI229 also integrates 3-axis magnetometer. HI229 is a low-cost, high-performance, small-size, low-latency Attitude Reference Unit (AHRS), integrating a 3-axis accelerometer, a 3-axis gyroscope, a 3-axis magnetometer, and a micro-controller. HI229 has the same features as HI226, but HI229 can output absolute heading directions and even work under harsh magnetic environments. </p> <p><img alt src=../figures/front_image.png></p> <p>Typical application:</p> <ul> <li>VR Motion capture</li> <li>Motion performance evaluation Attitude measurement in high dynamic environment</li> <li>Drone control</li> </ul> <h2 id=features>Features</h2> <h3 id=on-board-sensors>On-board sensors</h3> <ul> <li>Three-axis gyroscope with </li> <li>maximum range: ± 2000 °/s</li> <li>output rate up to 2000Hz</li> <li>Three-axis accelerometer with</li> <li>maximum range: ± 8g</li> <li>output rate up to 125Hz</li> <li>Three-axis magnetic field sensor with </li> <li>maximum range: 800mG</li> <li>internal sampling rate up to 100Hz</li> </ul> <h3 id=data-process>Data process</h3> <ul> <li>Accelerometer and gyroscope are calibrated by factory to correct 3-axis non-orthogonal and scale factor error.</li> <li>Quaternions and Euler angles are calculated in geographic coordinate system by data fusion algorithm.</li> </ul> <h3 id=communication-interface-and-power-supply-of-hi226-and-hi229>Communication interface and power supply of HI226 and HI229</h3> <ul> <li>Serial port (compatible with TTL, which can be directly connected with 5V or 3.3V serial port device)</li> <li>Supply voltage: 3.3 (&plusmn; 100 mV)</li> <li>Power consumption at peak：32mA</li> </ul> <h3 id=others>Others</h3> <ul> <li>We provide GUI on the PC(Win)side, providing real-time data display, waveform, calibration and data logging functions.</li> <li>Configurable parameters.</li> </ul> <h2 id=hardware-specifications>Hardware Specifications</h2> <h3 id=specifications>Specifications</h3> <table> <thead> <tr> <th>Parameter</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Data Interface</td> <td>UART (TTL 1.8V - 3.3V)</td> </tr> <tr> <td>Supply Voltage</td> <td>3.3V (± 100mV)</td> </tr> <tr> <td>Power Consumption</td> <td>86mW @3.3V</td> </tr> <tr> <td>Temperature Tolerance</td> <td>-20℃ - 85 ℃</td> </tr> <tr> <td>Maximum Linear Accelerations</td> <td>0 - 115 <span><span class=MathJax_Preview>m/s^2</span><script type=math/tex>m/s^2</script></span></td> </tr> <tr> <td>Size</td> <td>12 x 12 x 2.6mm (W x L x H)</td> </tr> <tr> <td>On-board Sensors</td> <td>3-axis gyroscope, 3-axis accelerometer (HI226 &amp; HI229). Hi229 has 3-axis magnetometer in addition.</td> </tr> </tbody> </table> <h3 id=size>Size</h3> <p><img alt src=../figures/assb.png></p> <table> <thead> <tr> <th>Symbol</th> <th>Minimum</th> <th>Type Value</th> <th>Maximum</th> <th>Unit</th> </tr> </thead> <tbody> <tr> <td>A1</td> <td>-</td> <td>11</td> <td>-</td> <td>mm</td> </tr> <tr> <td>B</td> <td>-</td> <td>11</td> <td>-</td> <td>mm</td> </tr> <tr> <td>D</td> <td>-</td> <td>12</td> <td>-</td> <td>mm</td> </tr> <tr> <td>E</td> <td>-</td> <td>12</td> <td>-</td> <td>mm</td> </tr> <tr> <td>H</td> <td>2.5</td> <td>2.6</td> <td>2.7</td> <td>mm</td> </tr> <tr> <td>a</td> <td>-</td> <td>1.5</td> <td>-</td> <td>mm</td> </tr> <tr> <td>b</td> <td>-</td> <td>0.9</td> <td>-</td> <td>mm</td> </tr> <tr> <td>c</td> <td>-</td> <td>1</td> <td>-</td> <td>mm</td> </tr> <tr> <td>e</td> <td>-</td> <td>1.27</td> <td>-</td> <td>mm</td> </tr> <tr> <td>f</td> <td>-</td> <td>1</td> <td>-</td> <td>mm</td> </tr> </tbody> </table> <h3 id=pin-definition>Pin Definition</h3> <p><img alt src=../figures/pin_assign.png></p> <table> <thead> <tr> <th>Pin Number</th> <th>Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>5</td> <td>N/C</td> <td>Reserved.</td> </tr> <tr> <td>6</td> <td>VCC</td> <td>Power input 3.3V</td> </tr> <tr> <td>7</td> <td>SYNC_OUT</td> <td>Data output synchronization: This pin is high when data is outputting, and low when it's idle.</td> </tr> <tr> <td>8</td> <td>RXD</td> <td>Module UART receive pin. (Connect TXD on host(MCU))</td> </tr> <tr> <td>9</td> <td>TXD</td> <td>Module UART transmit pin. (Connect RXD on host(MCU))</td> </tr> <tr> <td>10</td> <td>SYNC_IN</td> <td>Data input synchronization: internal pull down. The module outputs a frame of data when detecting a rising edge. The maximum synchronization frequency is 200Hz, and the output frame rate cannot exceed total bandwidth of the current serial port Baud rate.</td> </tr> <tr> <td>11</td> <td>N/C</td> <td>Reserved.</td> </tr> <tr> <td>19</td> <td>GND</td> <td>GND</td> </tr> <tr> <td>20</td> <td>RST</td> <td>Reset. internal pull up. &gt;10uS Low-level reset module. No external resistors or capacitors are required. It is recommended to connect the GPIO pins on MCU to implement controllable hardware reset.</td> </tr> <tr> <td>21</td> <td>N/C</td> <td>Reserved.</td> </tr> <tr> <td>22</td> <td>N/C</td> <td>Reserved.</td> </tr> <tr> <td>23</td> <td>N/C</td> <td>Reserved.</td> </tr> <tr> <td>24</td> <td>GND</td> <td>GND</td> </tr> <tr> <td>25</td> <td>N/C</td> <td>Reserved.</td> </tr> </tbody> </table> <h2 id=performance>Performance</h2> <h3 id=output-accuracy-of-attitude>Output accuracy of attitude</h3> <table> <thead> <tr> <th>Attitude</th> <th>Type</th> </tr> </thead> <tbody> <tr> <td>Roll Angle Pitch Angle - Error at static situations</td> <td>0.8°</td> </tr> <tr> <td>Roll Angle Pitch Angle - Error at dynamic situations</td> <td>2.5°</td> </tr> <tr> <td>Stability of Zero Offset</td> <td>10°/h</td> </tr> <tr> <td>Heading angle accuracy during movement (in 9-axis mode, without magnetic interference and after geomagnetic calibration)</td> <td>3°</td> </tr> </tbody> </table> <h3 id=gyroscope>Gyroscope</h3> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Measuring Range</td> <td>±2000°/s</td> </tr> <tr> <td>Non-linearity</td> <td>±0.1% (Has best performance at 25°)</td> </tr> <tr> <td>Noise density</td> <td>0.08°/s/<span><span class=MathJax_Preview>\sqrt{Hz}</span><script type=math/tex>\sqrt{Hz}</script></span></td> </tr> <tr> <td>Sampling Rate</td> <td>2000Hz</td> </tr> </tbody> </table> <h3 id=accelerometer>Accelerometer</h3> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Measuring Range</td> <td>±8G (1G = 1x Gravitational acceleration )</td> </tr> <tr> <td>Non-linearity</td> <td>±0.5% (Has best performance at 25°)</td> </tr> <tr> <td>Maximum Zero Offset</td> <td>10mG</td> </tr> <tr> <td>Noise Density</td> <td>250 <span><span class=MathJax_Preview>uG\sqrt{Hz}</span><script type=math/tex>uG\sqrt{Hz}</script></span></td> </tr> <tr> <td>Sampling Rate</td> <td>500Hz</td> </tr> </tbody> </table> <h3 id=magnetometer>Magnetometer</h3> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Measuring Range</td> <td>±8Gauss</td> </tr> <tr> <td>Non-linearity</td> <td>±0.1%</td> </tr> <tr> <td>Sampling Rate</td> <td>100Hz</td> </tr> </tbody> </table> <h3 id=data-interface-specifications>Data interface specifications</h3> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Serial Output Baud Rate</td> <td>4800/9600/115200/460800 (Optional)</td> </tr> <tr> <td>Output frame rate</td> <td>0/1/10/25/50/100/200/400/500Hz (Optional)</td> </tr> </tbody> </table> <h2 id=data-fusion-and-calibration-algorithm>Data Fusion and Calibration Algorithm</h2> <h3 id=calibration-of-gyroscope>Calibration of gyroscope</h3> <ul> <li>Each attitude sensor is individually calibrated and tested over the full measurement range. The non-orthogonal and scale factor error of the gyroscope and accelerometer are stored in internal flash.</li> <li>To obtain the best performance, the automatic calibration process of the gyroscope needs to be stationary for about 3s after powering on. </li> <li> <p>If the time for stillness is less than 3s, the accuracy of the gyro zero offset calibration will be reduced.</p> </li> <li> <p>The attitude sensor has a built-in gyro zero speed detection mechanism. When three-axis gyro speed is less than 1 ° / s for a period of time, the module considers attitude is stationary and the gyro output regards as zero bias. The gyro sensor output are considered as bias. So <strong>This product cannot be used in scenarios with rotation speed &lt;1 ° / s.</strong> (In other words, the rotation speed is lower than &#8537; of the average speed of the second pin of a clock)</p> </li> </ul> <h3 id=magnetic-interference-distortion-rejection-and-magnetic-calibration>Magnetic interference, Distortion rejection and magnetic calibration</h3> <h4 id=type-of-magnetic-interference>Type of magnetic interference</h4> <ul> <li>Interference in space</li> <li>Definition: Interference exists in the world coordinate system and does not move with sensor motion.</li> <li>Typical source: Various fixed sources of magnetic interference. For example, furniture, household appliances, cables, reinforced structures in houses, etc, are the sources. They don't move with the magnetic sensor.</li> <li>Interference: No matter how properly the magnetic field sensor is calibrated, the interference of these spatial magnetic fields (or the unevenness of the environmental magnetic field) will always cause the spatial geomagnetic field to be distorted. They will cause errors in geomagnetic compensation and heading angle. They are the main factors that make troubles to indoor geomagnetic fusion. This kind of interference cannot be calibrated, and it will seriously affect the geomagnetic performance especially the space magnetic interference indoors .</li> <li>Measure: Module has built-in homogeneous magnetic field detector and shielding of non-homogeneous magnetic field.</li> <li>Interference in the sensor coordinate system</li> <li>Definition: Interference source moves with sensor motion. </li> <li>Typical source: The printed circuit board of our module, and board and any device that attached with the module, are all regarded as the same rigid body as the magnetometer, and move with the magnetometer.</li> <li>Interference: Make hard magnetic / soft magnetic interference to the sensor. </li> <li>Measure: These interferences can be well eliminated by our geomagnetic calibration algorithm.</li> </ul> <p>The following figure shows a distribution map of typical indoor magnetic field. The spatial magnetic field distortion is servers indoors.</p> <p><img alt src=../figures/indoor_magnetic_field.png></p> <p><strong>Notes</strong> The spatial magnetic interference is particularly serious indoors, and it cannot be eliminated by calibration. Although the module has built-in homogeneous detector of magnetic field and shielding mechanism, the accuracy of the 9-axis mode heading angle is susceptible to the distortion of indoor magnetic field. If the indoor magnetic field of environment is messy, such as being near a computer room, electromagnetic experiments rooms, workshops, underground garages, the accuracy of heading angle of 9-axis mode may not be as good as that of the 6-axis mode, and even having large errors of angle after calibration.</p> <h4 id=operation-mode>Operation mode</h4> <p>The geomagnetic field is very susceptible to spatial interference, therefore you should be very careful when using the 9-axis mode. The following table lists the suggestions for different usage and working conditions.</p> <ul> <li> <p>6-axis mode</p> </li> <li> <p>Suitable environment : Anywhere.</p> </li> <li>Typical usage : Low dynamic attitude detection such as PTZ and indoor robot.</li> <li>Advantage : <ol> <li>Output of attitude angle is stable </li> <li>The sensor is completely immune to magnetic interference.</li> </ol> </li> <li> <p>Disadvantage : Heading angle drifts slowly over time</p> </li> <li> <p>9-axis mode</p> </li> <li> <p>Suitable environment : No magnetic environment</p> </li> <li> <p>Typical usage : </p> <ol> <li>Compass, north seeking system </li> <li>Use in an empty room with less magnetic interference, or less moving device in an area. For example, capture motion in a studio, </li> </ol> </li> <li> <p>Advantage : </p> <ol> <li>The heading angle does not drift with time.</li> <li>The heading angle can be quickly corrected to the north once the geomagnetic field is detected.</li> </ol> </li> <li> <p>Disadvantage : Any magnetic interference will reduce the accuracy of heading angle. In the case of severe interference indoors, the heading angle can not point to the correct direction. In addition, the metal structure of the mobile robot and the motor will generate strong magnetic interference, which make mobile robot platform not applicable for 9-axis mode.</p> </li> <li> <p>Note : You need to calibrate geomagnetic sensor before using it.</p> </li> </ul> <h4 id=geomagnetic-calibration>Geomagnetic Calibration</h4> <p>The module's automatic geomagnetic calibration system can only handle fixed magnetic field interference that is installed with the module, or this interference must be fixed in around, or the distance between interferences and the module should be constant. For example, while the module is installed on an iron material, the iron and the module need to be rotated and calibrated together because there is magnetic field interference from iron. Furthermore, the iron won't be separated from the compass during the using. If they are separated, it needs to be recalibrated. Beware, if the size of the iron is not fixed, or the distance between interferences and the module is not fixed, calibrations won't make effect. Even if it calibrate successfully, the accuracy will still be very poor. The only solution is to keep those interferences away at least 40CM.</p> <p>This module integrates an active non-interference geomagnetic calibration algorithm. The module will automatically collect the geomagnetic field information and perform hard magnetic calibration, which is also called the geomagnetic sensor zero offset. After the calibration successes, the calibration information will be saved in the flash memory for the future use. Users do not need any operation to realize the geomagnetic calibration. However, In the first time you use the module and set it to 9-axis mode, you should follow those steps:</p> <ol> <li>Slowly perform 8-shaped motion or 360 degrees around each axis of the module in a small range, and hold the posture of module as various as possible.</li> <li>If the geomagnetic interference is within a acceptable range, the calibration can be completed. It's unnecessary to recalibrate in the same geomagnetic environment or the same location. If the module couldn't be calibrated successfully, you should suspect that there is severe geomagnetic interference in surroundings.</li> </ol> <p>You can check the geomagnetic calibration status by those AT commands :</p> <p>Send the command <code>AT + INFO = HSI</code>, and the module will print the current status of the geomagnetic calibration system:</p> <p><img alt src=../figures/magcal_hsi.png></p> <table> <thead> <tr> <th>The Showing of HSI Parameter</th> <th>Meaning</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>valid</td> <td>Geomagnetic calibration is valid</td> <td>0: No successful calibration. Non-zero: Calibration parameters already exist.</td> </tr> <tr> <td>fiterr</td> <td>Fitted value of residuals</td> <td>The smaller the residual error, the better the parameter fitting effect, It's usually below 0.05, which is good enough. If the fitting result is always &gt; 0.1, meaning that there is severe geomagnetic interference.</td> </tr> <tr> <td>bin_status</td> <td>Acquisition progress of current geomagnetic data</td> <td>This represents the latest geomagnetic data collection progress, as a percentage of 0-100%. While it reaches 100%, the geomagnetic calibration parameters will be fitted.</td> </tr> <tr> <td>cal_cnt</td> <td>Number of successful calibrations</td> <td>The accumulated number of times that fitter has calibrated. This number is saved after powering off.</td> </tr> <tr> <td>flux</td> <td>Geomagnetic field strength estimated by the fitter</td> <td>Estimated geomagnetic field strength in "uT" by the most recent fitter</td> </tr> <tr> <td>inclination</td> <td>Geomagnetic inclination estimated by the fitter</td> <td>Magnetic dip estimated in "°" by the most recent fitter</td> </tr> </tbody> </table> <ul> <li>The estimator can automatically collect data online and dynamically fit the geomagnetic calibration parameters. However, if the geomagnetic environment changes (such as switching to another room or changing between indoor and outdoor), we suggest that you recalibrate.</li> </ul> <h2 id=hardware-installation-and-welding>Hardware Installation and Welding</h2> <ol> <li>The installation position should be far away from the easy deformation point of the PCB, as far as possible from the edge of the PCB (&gt; 30mm) and the screw hole of PCB (&gt; 10mm).</li> </ol> <p><img alt src=../common_figures/soldering1.png></p> <ol> <li> <p>The installation location should be far away from strong magnetic devices, such as motors, speakers and other strong magnetic devices.</p> </li> <li> <p>Since MEMS sensors are very sensitive to stress on PCB board, <strong>we suggest you that solder the modules by hand, instead of using reflow soldering, otherwise the sensor performance will be affected.</strong> If reflow soldering must be used, you should notice that the solder paste is printed on the screen with a printing squeegee, so that the solder paste is leaked onto the PCB through the screen opening. In order to ensure the quality of reflow soldering, it is recommended that the thickness of the stencil corresponding to the pad be 0.18mm.</p> </li> <li> <p>The assembled PCB must not be cleaned with an ultrasonic cleaner.</p> </li> <li> <p>Do not use plastic seals or spray paints on this product. Those will change stress in sensor and affect its performance.</p> </li> </ol> <p><img alt src=../common_figures/soldering2.png></p> <ol> <li>The recommended furnace temperature curve for reflow is as follows :</li> </ol> <p><img alt src=../common_figures/soldering3.png></p> <p>Reference : <a href=https://ae-bst.resource.bosch.com/media/_tech/media/application_notes/BST-MAS-HS000.pdf>https://ae-bst.resource.bosch.com/media/_tech/media/application_notes/BST-MAS-HS000.pdf</a></p> <h2 id=definition-of-reference-frame>Definition of Reference Frame</h2> <p>This product uses <strong>right-hand</strong> (cartesian) coordinate system. The output of quaternions and Euler angles are the rotation from the sensor coordinate system to the inertial coordinate system (which is also called world coordinate system). </p> <p>The rotation order of Euler angles is ZYX (Z axis first, then Y axis, and finally X axis), which is specifically defined as follows :</p> <ul> <li>Rotate around Z axis : Yaw, phi (<span><span class=MathJax_Preview>\psi</span><script type=math/tex>\psi</script></span>) . The range is -180° to 180°</li> <li>Rotate around Y axis : Pitch, theta (<span><span class=MathJax_Preview>\theta</span><script type=math/tex>\theta</script></span>) . The range is -90° to 90°</li> <li>Rotate around X axis : Roll, psi (<span><span class=MathJax_Preview>\phi</span><script type=math/tex>\phi</script></span>) . The range is -180° to 180°</li> </ul> <p>This product uses (North-West-Up, NWU) coordinate system, which is defined as follows：</p> <ul> <li>Positive X axis points to north</li> <li>Positive Y axis points to west</li> <li>Positive Z axis points to the sky</li> </ul> <p>When using the NWU system and the module is simulated as an aircraft, the X axis should be considered as heading direction. When the coordinate system of sensor and world are coincide, the ideal output of the Euler angles should be : </p> <ul> <li>Pitch = 0 °, Roll = 0 °, Yaw = 0 °</li> </ul> <h2 id=application-guide>Application Guide</h2> <h3 id=connection-between-module-and-pc>Connection Between Module and PC</h3> <p>It is recommended to use an evaluation board to connect with a PC. The evaluation board has on-board USB power supply and Micro-USB to serial port converter. You can use the evaluation software on the PC for module performance testing directly. Please read the appendix A for more details.</p> <h3 id=connection-between-module-and-micro-controller>Connection Between Module and Micro Controller</h3> <p>The module and MCU are connected through a TTL-level serial port. We suggest that the RST pin of the module be connected to the MCU's GPIO for MCU to force reset the module.</p> <p><img alt src=../common_figures/connection_with_mcu.png></p> <h3 id=notice>Notice</h3> <ol> <li>If you do not use the synchronous input (SYNC_IN) and synchronous output function (SYNC_OUT), do not connect SYNC_IN and SYNC_OUT.</li> <li>Keep the 120 ohm resistor to facilitate debugging and prevent a mismatch between MCU resetting and the module. Removing the resistor will not affect its operation. However, it is recommended to keep it.</li> <li>The voltage range of VCC is specifically explained in the user guide.</li> </ol> <h2 id=protocol-of-serial-communication>Protocol of Serial Communication</h2> <h3 id=format-of-a-packet>Format of a Packet</h3> <p>For more applications, we provide data analysis functions by C and C# in supporting resources. After the module is powered on, the packets output rate is set by default at 100Hz (factory default output rate). The format of data packet is described as follows :</p> <table> <thead> <tr> <th>Field</th> <th>Syncing frame header</th> <th>Frame type</th> <th>Frame length</th> <th>CRC16</th> <th>Data in a frame</th> </tr> </thead> <tbody> <tr> <td>name</td> <td>PRE</td> <td>TYPE</td> <td>LEN</td> <td>CRC</td> <td>REG_ADDR(N) + DATA(N)</td> </tr> <tr> <td>size (byte)</td> <td>0</td> <td>1</td> <td>2</td> <td>2</td> <td>variable (1-64)</td> </tr> <tr> <td>shift (byte)</td> <td>0</td> <td>1</td> <td>2</td> <td>4</td> <td>6</td> </tr> <tr> <td>value (hex)</td> <td>0x5A</td> <td>0xA5</td> <td>length value</td> <td>CRC check code</td> <td>check more details in the next section</td> </tr> <tr> <td>type</td> <td>uint8_t</td> <td>uint8_t</td> <td>uint16_t</td> <td>uint16_t</td> <td>-</td> </tr> </tbody> </table> <ul> <li> <p>PRE It's fixed at 0x5A.</p> </li> <li> <p>TYPE It's fixed at 0xA5 representing a data frame.</p> </li> <li> <p>LEN The length of data field in a data frame. The maximum of a data frame is 256 bytes LSB (low byte first), and the length only includes of the real data, not including <code>PRE</code>,<code>TYPE</code>,<code>LEN</code>,<code>CRC</code> numeric field.</p> </li> <li> <p>CRC 16-bit CRC checksum of all the other data and LSB[^LSB] in a frame, except the CRC itself. CRC implementing functions is presented as follows：</p> </li> </ul> <div class=highlight><pre><span></span>/*
    currectCrc: previous crc value, set 0 if it&#39;s first section
    src: source stream data
    lengthInBytes: length
*/
static void crc16_update(uint16_t *currectCrc, const uint8_t *src, uint32_t lengthInBytes)
{
    uint32_t crc = *currectCrc;
    uint32_t j;
    for (j=0; j &lt; lengthInBytes; ++j)
    {
        uint32_t i;
        uint32_t byte = src[j];
        crc ^= byte &lt;&lt; 8;
        for (i = 0; i &lt; 8; ++i)
        {
            uint32_t temp = crc &lt;&lt; 1;
            if (crc &amp; 0x8000)
            {
                temp ^= 0x1021;
            }
            crc = temp;
        }
    } 
    *currectCrc = crc;
}
</pre></div> <ul> <li>REG_ADDR and DATA A frame of data can be composed of multiple data packets. Each data packet contains two parts: register address (REG_ADDR) and register data (DATA). The register address determines the type and length of the data, and DATA is the content of register data. Supported list of registers in the module is described as follows :</li> </ul> <table> <thead> <tr> <th>Register address</th> <th>Bytes in register</th> <th>Name</th> <th>Unit</th> </tr> </thead> <tbody> <tr> <td>0x90</td> <td>1</td> <td>user ID of the module</td> <td>N/A</td> </tr> <tr> <td>0xA0</td> <td>6</td> <td>acceleration</td> <td>0.001G[^G]</td> </tr> <tr> <td>0xA5</td> <td>6</td> <td>linear acceleration</td> <td>0.001G</td> </tr> <tr> <td>0xB0</td> <td>6</td> <td>angular velocity</td> <td>0.1°/s</td> </tr> <tr> <td>0xC0</td> <td>6</td> <td>strength of magnetic field</td> <td>0.001Gauss</td> </tr> <tr> <td>0xD0</td> <td>6</td> <td>Euler angles (as integer)</td> <td>1°</td> </tr> <tr> <td>0xD9</td> <td>12</td> <td>Euler angles (as float/double)</td> <td>1°</td> </tr> <tr> <td>0xD1</td> <td>16</td> <td>quaternion</td> <td>N/A</td> </tr> <tr> <td>0xF0</td> <td>4</td> <td>air pressure</td> <td>Pa</td> </tr> <tr> <td>0x71</td> <td>128-256 bytes (variable)</td> <td>Quaternion collection from wireless nodes</td> <td>N/A</td> </tr> <tr> <td>0x72</td> <td>48-96 bytes (variable)</td> <td>Euler angles collection from wireless nodes</td> <td>1°</td> </tr> <tr> <td>0x75</td> <td>48-96 bytes (variable)</td> <td>acceleration collection from wireless nodes</td> <td>0.001G[^G]</td> </tr> <tr> <td>0x78</td> <td>48-96 bytes (variable)</td> <td>angular velocity collection of wireless nodes</td> <td>0.1°/s</td> </tr> <tr> <td>0x61</td> <td>3</td> <td>extensive identification of the wireless data frame</td> <td>N/A</td> </tr> </tbody> </table> <p>[^G]: 1G = 1x (Local gravitational acceleration)</p> <ul> <li>0x90 user ID of the module</li> <li>0xA0 Raw acceleration of the sensor, outputted as int16, and three axes in total. Each axis occupies 2 bytes, so the total of X, Y, Z axes is 6 bytes, and LSB.</li> <li>0xA5 Linear acceleration value without gravity in geographic coordinate system, outputted as int16. There are 3 axes, X, Y, and Z, each axis occupies 2 bytes, so the total is 6 bytes, and LSB.</li> <li>0xB0 Angular velocity of the sensor, outputted as int16. There are 3 numbers for 3 axes, X, Y, and Z, and each number occupies 2 bytes, so the total of them is 6 bytes, LSB.</li> <li>0xC0 The strength of magnetic field measured by the sensor, outputted as int16. There are numbers in 3 axes, X, Y, and Z, and each number occupies 2 bytes, so the total is 6 bytes, LSB.</li> <li>0xD0 Euler angles of the sensor, outputted as int16. There are 3 numbers, , and the order is Pitch-Roll-Yaw for 3 axes, X, Y, and Z, . Each number occupies 2 bytes, LSB. The values of Roll and Pitch you received need to be divided by 100 , and Yaw needs to be divided by 10 to get the true angles：<ul> <li>ex. When you receive Yaw = 100, the heading angle is 10 °.</li> </ul> </li> <li>0xD9 Euler angles of the sensor, outputted as float. There are 3 numbers, Pitch, Roll and Yaw for 3 axes, X, Y, and Z. Each number occupies 4 bytes (float), LSB.</li> <li> <p>0XD1 Quaternion of the sensor, outputted as float. The data contains four number, which is put in order of W-X-Y-Z. Each of the number occupies 4 bytes (float), so the total size of quaternion is 16 bytes, and LSB.</p> </li> <li> <p>0XF0 Air pressure. Only works for products with pressure sensor.</p> </li> <li> <p>0x71 <strong>Only support HI221GW(receiver)</strong>. The collection of quaternions from wireless nodes. A frame consists of a series of quaternions from the nodes, in order of the <strong>user ID</strong> you set. For example, you set nodes ID from 0 to 5, there will be 6 nodes totally. Each node occupies 16 bytes , and consists of a quaternion that is W, X, Y, and Z. Every value is stored in the float type, and each float occupies 4 bytes, and LSB.</p> </li> <li> <p>0x72 <strong>Only support HI221GW(receiver)</strong>. The collection of Euler angles of wireless nodes. A frame consists of a series of Euler angles from the nodes, in order of the <strong>user ID</strong> you set. For example, you set nodes ID from 0 to 5, there will be 6 nodes totally. Each node occupies 6 bytes, and consists of 3 integers(int16) in order of Pitch-Roll-Yaw, and each integer occupies 2 bytes, and LSB. The values of Roll and Pitch you received need to be divided by 100 , and Yaw needs to be divided by 10 to get the true angles：</p> <ul> <li>ex. When you receive Yaw = 100, the heading angle is 10 °.</li> </ul> </li> <li> <p>0x75 <strong>Only support HI221GW(receiver)</strong>. The collection of accelerations from wireless nodes. This section consists of a series of accelerations from the nodes, in order of the <strong>user ID</strong> you set. Each node contains 3 <strong>int16_t</strong>, in order of X, Y, and Z. Note that an <strong>int16_t</strong> occupies 2bytes, and LSB.</p> </li> <li> <p>0x78 <strong>Only support HI221GW(receiver)</strong>. The collection of angular velocities from wireless nodes . This section consists of a series of angular velocities from the nodes, in order of the <strong>user ID</strong> you set. Each node contains 3 <strong>int16_t</strong>, in order of X, Y, and Z. Note that an <strong>int16_t</strong> occupies 2bytes, and LSB.</p> </li> <li> <p>0x61</p> </li> </ul> <p><strong>Only support HI221GW(receiver)</strong>. Get extensive identification of the wireless data frame, 3 bytes in total.</p> <table> <thead> <tr> <th>Bytes offset in data frame extension identification</th> <th>Value</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>-</td> <td>N/A</td> </tr> <tr> <td>1</td> <td>GWID</td> <td>GWID of a receiver</td> </tr> <tr> <td>2</td> <td>CNT</td> <td>the count of nodes contained in this frame : 1-16</td> </tr> </tbody> </table> <h3 id=factory-default-register>Factory Default Register</h3> <p>The register data carried in one frame by factory default is defined as follows :</p> <p>HI226/HI229:</p> <table> <thead> <tr> <th>Order</th> <th>Data packet</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>0x90</td> <td>user ID of module</td> </tr> <tr> <td>2</td> <td>0xA0</td> <td>accelerations</td> </tr> <tr> <td>3</td> <td>0xB0</td> <td>angular velocities</td> </tr> <tr> <td>4</td> <td>0xC0</td> <td>strength of magnetic field</td> </tr> <tr> <td>5</td> <td>0xD0</td> <td>Euler angles as integer</td> </tr> <tr> <td>6</td> <td>0xF0</td> <td>air pressure</td> </tr> </tbody> </table> <p>HI221GW(wireless receiver of nodes):</p> <table> <thead> <tr> <th>Order</th> <th>in Register</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>0x71</td> <td>quaternions</td> </tr> <tr> <td>2</td> <td>0x75</td> <td>angular velocities</td> </tr> </tbody> </table> <h3 id=example-of-data-structure-in-a-frame>Example of Data Structure in a Frame</h3> <p>Let's assume that <code>A0, B0, D0</code> are in a frame of some output data . Use the serial assistant to sample a frame of data, and find the following value :</p> <p><code>5A</code> <code>A5</code> <code>15</code> <code>00</code> <code>A9</code> <code>8B</code> <code>A0</code> <code>EA</code> <code>FF</code> <code>D0</code> <code>03</code> <code>45</code> <code>FF</code> <code>B0</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> <code>D0</code> <code>87</code> <code>00</code> <code>6F</code> <code>27</code> <code>F5</code> <code>FF</code> </p> <p>where：</p> <p><code>5A</code> <code>A5</code> is frame header.</p> <p><code>15</code> <code>00</code> is the length of data field : (0x00&lt;&lt;8) + 0x15 = 21</p> <p><code>A9</code> <code>8B</code> is the checksum of CRC : (0x8B&lt;&lt;8) + 0xA9 = 0x8BA9</p> <ul> <li><code>A0</code> <code>EA</code> <code>FF</code> <code>D0</code> <code>03</code> <code>45</code> <code>FF</code> are the accelerations, <code>A0</code> is the register address of accelerations. Therefore, the linear accelerations of 3 axes are：</li> </ul> <p>AccX = (int16_t)((0xFF&lt;&lt;8)+ 0xEA) = -22 AccY = (int16_t)((0x03&lt;&lt;8)+ 0xD0) = 976 AccZ = (int16_t)((0xFF&lt;&lt;8)+ 0x45) = -187</p> <ul> <li> <p><code>B0</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> <code>00</code> are angular velocities, <code>B0</code> is the register address of angular velocities. From these values, we find that angular velocities around 3 axes are all zero.</p> </li> <li> <p><code>D0</code> <code>87</code> <code>00</code> <code>6F</code> <code>27</code> <code>F5</code> <code>FF</code> are Euler angles, <code>D0</code> is the register address of Euler angles. From these values, we find that :</p> </li> </ul> <p>Pitch= (int16_t)((0x00&lt;&lt;8)+ 0x87) / 100 = 1.35° Roll= (int16_t)((0x27&lt;&lt;8)+ 0x6F) / 100 = 100.95° Yaw = (int16_t)((0xFF&lt;&lt;8)+ 0xF5) / 10 = -1.1°</p> <ul> <li> <p>Calculate the CRC ： Remember that the frame of data is received and stored in the buffer of C language <strong>uint8_t</strong> array : </p> <div class=highlight><pre><span></span>uint16_t payload_len;
uint16_t crc;

crc = 0;
payload_len = buf[2] + (buf[3] &lt;&lt; 8);

/* calulate 5A A5 and LEN filed crc */
crc16_update(&amp;crc, buf, 4);

/* calulate payload crc */
crc16_update(&amp;crc, buf + 6, payload_len);
</pre></div> <p>After calculating, the CRC checksum is 0x8BA9, same as the CRC value carried in the frame. The check result is correct</p> </li> </ul> <h2 id=general-at-command>General AT Command</h2> <p>The Module parameters can be configured and checked by AT commands. AT commands always start with the ASCII code <code>AT</code>, followed by the control characters, and end with a carriage return and linefeed <code>\r\n</code>. You can use any serial debugging assistant for testing.</p> <p><img alt src=../common_figures/at_cmd.png></p> <p>General AT Commands :</p> <table> <thead> <tr> <th>Command</th> <th>Function</th> <th>Configure once (N) / Configure permanent after restart (Y)</th> </tr> </thead> <tbody> <tr> <td>AT+ID</td> <td>Set a user ID for the module</td> <td>Y</td> </tr> <tr> <td>AT+GWID</td> <td>Assign an ID to the wireless network domain (for wireless product)</td> <td>Y</td> </tr> <tr> <td>AT+URFR</td> <td>Rotate the coordinate system of the module</td> <td>Y</td> </tr> <tr> <td>AT+INFO</td> <td>Print out the information of module</td> <td>N</td> </tr> <tr> <td>AT+ODR</td> <td>Set the output frequency for a frame of module data</td> <td>Y</td> </tr> <tr> <td>AT+BAUD</td> <td>Set Baud for serial port</td> <td>Y</td> </tr> <tr> <td>AT+EOUT</td> <td>A switch for the output data</td> <td>N</td> </tr> <tr> <td>AT+RST</td> <td>Reset the module</td> <td>N</td> </tr> <tr> <td>AT+TRG</td> <td>Trigger the module to output a frame</td> <td>N</td> </tr> <tr> <td>AT+SETPEL</td> <td>Configure the content in a frame</td> <td>Y</td> </tr> <tr> <td>AT+MODE</td> <td>Set an operation mode of the module</td> <td>Y</td> </tr> </tbody> </table> <h5 id=atid>AT+ID</h5> <p>Set a user ID for the module</p> <p>ex. <code>AT+ID=1</code></p> <h5 id=atgwid>AT+GWID</h5> <p>Only support HI221. HI221GW (receiver) and HI221 (node) have GWID attribute, you can assign a number of GWID for specific radio frequency by AT+GWID command, and only when both node and the receiver are in the same GWID, they can communicate with each other. GWID is just like a wireless network domain. If you're using more than one receiver to establish multiple star networks, you have to assign different GWID to each receiver。</p> <p>ex. set GWID=3 for a receiver, meanwhile there are three nodes are individually set to 0,1, and 2. Let them be able to communicate with the receiver.</p> <p>Command for</p> <p>receiver：<code>AT+GWID=3</code></p> <p>node 0： <code>AT+GWID=3</code> <code>AT+ID=0</code></p> <p>node 1： <code>AT+GWID=3</code> <code>AT+ID=1</code></p> <p>node 2： <code>AT+GWID=3</code> <code>AT+ID=2</code></p> <h5 id=aturfr>AT+URFR</h5> <p>In some cases the IMU sensor needs to be installed tilted or vertically. This command helps you to rotate the coordinate system of the sensor：</p> <p>ex.<code>AT+URFR=C00,C01,C02,C10,C11,C12,C20,C21,C22</code> </p> <p>where <span><span class=MathJax_Preview>C_{nn}</span><script type=math/tex>C_{nn}</script></span> support float and double type.</p> <div> <div class=MathJax_Preview> \left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{U}=\left[\begin{array}{lll}{C 00} &amp; {C 01} &amp; {C 02} \\ {C 10} &amp; {C 11} &amp; {C 12} \\ {C 20} &amp; {C 21} &amp; {C 22}\end{array}\right] \cdot\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{B} </div> <script type="math/tex; mode=display">
\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{U}=\left[\begin{array}{lll}{C 00} & {C 01} & {C 02} \\ {C 10} & {C 11} & {C 12} \\ {C 20} & {C 21} & {C 22}\end{array}\right] \cdot\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{B}
</script> </div> <p>where <span><span class=MathJax_Preview>\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{U}</span><script type=math/tex>\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{U}</script></span> are the measurement data after coordinate system correction, and <span><span class=MathJax_Preview>\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{B}</span><script type=math/tex>\left\{\begin{array}{l}{X} \\ {Y} \\ {Z}\end{array}\right\}_{B}</script></span> are the measurement data before coordinate system calibration.</p> <p>Some examples of commands：</p> <ul> <li> <p>Rotate N° around original X or Y or Z axis as a new coordinate system</p> <ul> <li>90° around original X axis : <code>AT+URFR=1,0,0,0,0,1,0,-1,0</code></li> <li>-90° around original X axis : <code>AT+URFR=1,0,0,0,0,-1,0,1,0</code></li> <li>180° around original X axis : <code>AT+URFR=1,0,0,0,-1,0,0,0,-1</code></li> <li>90° around original Y axis : <code>AT+URFR= 0,0,-1,0,1,0,1,0,0</code></li> <li>-90° around original Y axis : <code>AT+URFR= 0,0,1,0,1,0,-1,0,0</code></li> <li>180° around original Y axis : <code>AT+URFR= -1,0,0,0,1,0,0,0,-1</code></li> </ul> </li> <li> <p>Factory reset：<code>AT+URFR=1,0,0,0,1,0,0,0,1</code></p> </li> </ul> <h5 id=atinfo>AT+INFO</h5> <p>Print the module information, including model, version, firmware and release date, etc. There are secondary instructions for AT + INFO to achieve more information.</p> <table> <thead> <tr> <th>INFO secondary instruction</th> <th>Function</th> <th>Example</th> </tr> </thead> <tbody> <tr> <td>CAL</td> <td>Print internal calibration parameters of the module.</td> <td>AT+INFO=CAL</td> </tr> <tr> <td>RF</td> <td>Print parameters of the wireless product.</td> <td>AT+INFO=RF</td> </tr> <tr> <td>VER</td> <td>Print details of the firmware version</td> <td>AT+INFO=VER</td> </tr> </tbody> </table> <h5 id=atodr>AT+ODR</h5> <p>Set the serial output rate of the module. It can be stored when the power off, and takes effect after restarting the module.</p> <p>ex. set the rate to 100Hz: <code>AT+ODR=100</code> </p> <h5 id=atbaud>AT+BAUD</h5> <p>Set Baud only in these options：4800/9600/115200/256000/460800`</p> <p>ex. <code>AT+BAUD=115200</code></p> <p>!!! Notice</p> <ul> <li>Beware that wrong Baud will result in failure of communication with the module.</li> <li>The receiver and module must be in the same Baud.</li> <li>Baud must be set to 115200 before you updating the firmware.</li> </ul> <h5 id=ateout>AT+EOUT</h5> <p>A switch of the output from module.</p> <p>ex. </p> <ul> <li>Open the serial port of module : <code>AT+EOUT=1</code> </li> <li>Close the serial port of module : <code>AT+EOUT=0</code></li> </ul> <h5 id=atrst>AT+RST</h5> <p>Reset the module.</p> <p>ex. <code>AT+RST</code></p> <h5 id=attrg>AT+TRG</h5> <p>Trigger the module to output a frame. It can cooperate with AT + ODR = 0 to trigger a single output。</p> <p>ex. <code>AT+TRG</code></p> <h5 id=atsetpel>AT+SETPEL</h5> <p>Set the output protocol:</p> <p>The content in a frame of data can be configured using AT commands, by following the format: <code>AT+SETPTL=&lt;ITEM_ID&gt;,&lt;ITEM_ID&gt;...</code> A frame of data can contain up to 8 packets.</p> <p>ex. Configure the module to output acceleration, angular velocity, Euler angle and quaternion in the format ：<code>AT+SETPTL=A0,B1,D0,D1</code></p> <p><img alt src=../common_figures/at_setptl.png></p> <h5 id=atmode>AT+MODE</h5> <p>Set the operation mode for the module.</p> <p>ex. </p> <ul> <li>Set the module to work in 6-axis mode (without magnetic calibration) <code>AT+MODE=0</code></li> <li>Set the module to work in 9-axis mode (will calibrate the heading angle by geomagnetic field sensor) <code>AT+MODE=1</code></li> </ul> <h2 id=appendix-a-evaluation-board>Appendix A - Evaluation Board</h2> <p><img alt src=../common_figures/hi2xxdk_1.png></p> <h3 id=overview>Overview:</h3> <p>This evaluation board provides a quick way to evaluate our IMU modules, which contains those features :</p> <ul> <li>An on-board Micro-USB interface, which provides USB to serial port communication, and supplies power to this platform.</li> <li>Supplying 3.3V 100mA to IMU module via on-board CP2104 USB-UART chip.</li> </ul> <h3 id=getting-started>Getting started:</h3> <ol> <li>Install "CP2104 USB-UART" driver from our website.</li> <li>Connect your Micro-USB cable on the evaluation platform, and the other end to an available USB port on the host PC.</li> <li>Run "Uranus" program on host PC, and choose the serial port you connected.</li> <li>The evaluation board will output packets via 115200-N-8-N-1 by default.</li> </ol> <h3 id=remove-the-product-from-the-evaluation-board>Remove the product from the evaluation board:</h3> <p>The IMU module is embedded in the PLCC-28 slot by default. To remove the module, please follow these steps: - Power off and prepare a screwdriver or tweezers. - Pry out the module from the PLCC socket, or eject it from the circular hole on the back.</p> <p>### Notice</p> <ul> <li>The evaluation board can only be used for simple evaluation for performance of IMU module. The USB interface is not designed for intended, industrial or high-motion scenes, and we don't recommend using evaluation board directly in such conditions if you need reliability.</li> <li>When using the evaluation board, the serial port of the module is connected to the USB-UART chip. Notice that UART can only communicate one-to-one. Do NOT connect the IMU module or the TX/RX pin to other serial device. Otherwise it will physically damage both evaluation board and IMU module. </li> </ul> <h2 id=appendix-b-conversion-between-quaternion-and-euler-angles>Appendix B - Conversion Between Quaternion and Euler Angles</h2> <h3 id=basic-conceptions-of-quaternion>Basic conceptions of quaternion</h3> <p>Quaternion is a number system that extends the complex numbers, representing a point in four-dimensional space：<span><span class=MathJax_Preview>q \in \mathbb{R}^{4}=\mathbb{H}</span><script type=math/tex>q \in \mathbb{R}^{4}=\mathbb{H}</script></span></p> <p>This table shows several representation of quaternions：</p> <table> <thead> <tr> <th>in complex numbers</th> <th>in vector</th> <th>representation 1</th> <th>representation 2</th> </tr> </thead> <tbody> <tr> <td><span><span class=MathJax_Preview>q=q_{0}+\mathrm{i} q_{1}+\mathrm{j} q_{2}+\mathrm{k} q_{3}</span><script type=math/tex>q=q_{0}+\mathrm{i} q_{1}+\mathrm{j} q_{2}+\mathrm{k} q_{3}</script></span></td> <td><span><span class=MathJax_Preview>q=\left[q_{0}, \mathbf{q}\right]=\left[q_{0},\left(\begin{array}{l}{q_{1}} \\ {q_{2}} \\ {q_{3}}\end{array}\right)\right]</span><script type=math/tex>q=\left[q_{0}, \mathbf{q}\right]=\left[q_{0},\left(\begin{array}{l}{q_{1}} \\ {q_{2}} \\ {q_{3}}\end{array}\right)\right]</script></span></td> <td><span><span class=MathJax_Preview>q=\left[q_{0}, q_{1}, q_{2}, q_{3}\right]</span><script type=math/tex>q=\left[q_{0}, q_{1}, q_{2}, q_{3}\right]</script></span></td> <td><span><span class=MathJax_Preview>q=\left[q_{w}, q_{x}, q_{y}, q_{z}\right]</span><script type=math/tex>q=\left[q_{w}, q_{x}, q_{y}, q_{z}\right]</script></span></td> </tr> </tbody> </table> <p>How to multiplicate basis elements：</p> <div> <div class=MathJax_Preview> \mathrm{i}^{2}=\mathrm{j}^{2}=\mathrm{k}^{2}=\mathrm{ijk}=-1 </div> <script type="math/tex; mode=display">
\mathrm{i}^{2}=\mathrm{j}^{2}=\mathrm{k}^{2}=\mathrm{ijk}=-1
</script> </div> <div> <div class=MathJax_Preview> \mathrm{ij}=\mathrm{k}=-\mathrm{ji}, \quad \mathrm{jk}=\mathrm{i}=-\mathrm{kj}, \quad \mathrm{ki}=\mathrm{j}=-\mathrm{ik} </div> <script type="math/tex; mode=display">
\mathrm{ij}=\mathrm{k}=-\mathrm{ji}, \quad \mathrm{jk}=\mathrm{i}=-\mathrm{kj}, \quad \mathrm{ki}=\mathrm{j}=-\mathrm{ik}
</script> </div> <p>How to multiplicate two quaternions：</p> <div> <div class=MathJax_Preview> \mathbf{p} \otimes \mathbf{q}=\left[\begin{array}{l}{p_{w} q_{w}-p_{x} q_{x}-p_{y} q_{y}-p_{z} q_{z}} \\ {p_{w} q_{x}+p_{x} q_{w}+p_{y} q_{z}-p_{z} q_{y}} \\ {p_{w} q_{y}-p_{x} q_{z}+p_{y} q_{w}+p_{z} q_{x}} \\ {p_{w} q_{z}+p_{x} q_{y}-p_{y} q_{x}+p_{z} q_{w}}\end{array}\right] </div> <script type="math/tex; mode=display">
\mathbf{p} \otimes \mathbf{q}=\left[\begin{array}{l}{p_{w} q_{w}-p_{x} q_{x}-p_{y} q_{y}-p_{z} q_{z}} \\ {p_{w} q_{x}+p_{x} q_{w}+p_{y} q_{z}-p_{z} q_{y}} \\ {p_{w} q_{y}-p_{x} q_{z}+p_{y} q_{w}+p_{z} q_{x}} \\ {p_{w} q_{z}+p_{x} q_{y}-p_{y} q_{x}+p_{z} q_{w}}\end{array}\right]
</script> </div> <p>An unit quaternion can always can be ：<span><span class=MathJax_Preview>q_{R}(\alpha, \mathbf{u})=\left[\cos \frac{\alpha}{2}, \sin \frac{\alpha}{2} \cdot \mathbf{u}\right]</span><script type=math/tex>q_{R}(\alpha, \mathbf{u})=\left[\cos \frac{\alpha}{2}, \sin \frac{\alpha}{2} \cdot \mathbf{u}\right]</script></span></p> <p>where <span><span class=MathJax_Preview>\alpha</span><script type=math/tex>\alpha</script></span> is rotation angle，<span><span class=MathJax_Preview>\mathbf{u} \in \mathbb{R}^{3}</span><script type=math/tex>\mathbf{u} \in \mathbb{R}^{3}</script></span> is rotation axis，and <span><span class=MathJax_Preview>\|\mathbf{u}\|=1</span><script type=math/tex>\|\mathbf{u}\|=1</script></span>.</p> <h3 id=conversion-between-quaternions-rotation-matrices-and-euler-angles>Conversion between quaternions, rotation matrices, and Euler angles</h3> <h4 id=quaternion-rotation-matrix>Quaternion -&gt; Rotation matrix</h4> <div> <div class=MathJax_Preview> R^{b}_{n} =\left[\begin{array}{ccc}{q_{0}^{2}+q_{1}^{2}-q_{2}^{2}-q_{3}^{2}} &amp; {2\left(q_{1} q_{2}+q_{0} q_{3}\right)} &amp; {2\left(q_{1} q_{3}-q_{0} q_{2}\right)} \\ {2\left(q_{1} q_{2}-q_{0} q_{3}\right)} &amp; {q_{0}^{2}-q_{1}^{2}+q_{2}^{2}-q_{3}^{2}} &amp; {2\left(q_{2} q_{3}+q_{0} q_{1}\right)} \\ {2\left(q_{1} q_{3}+q_{0} q_{2}\right)} &amp; {2\left(q_{2} q_{3}-q_{0} q_{1}\right)} &amp; {q_{0}^{2}-q_{1}^{2}-q_{2}^{2}+q_{3}^{2}}\end{array}\right] </div> <script type="math/tex; mode=display">
R^{b}_{n} =\left[\begin{array}{ccc}{q_{0}^{2}+q_{1}^{2}-q_{2}^{2}-q_{3}^{2}} & {2\left(q_{1} q_{2}+q_{0} q_{3}\right)} & {2\left(q_{1} q_{3}-q_{0} q_{2}\right)} \\ {2\left(q_{1} q_{2}-q_{0} q_{3}\right)} & {q_{0}^{2}-q_{1}^{2}+q_{2}^{2}-q_{3}^{2}} & {2\left(q_{2} q_{3}+q_{0} q_{1}\right)} \\ {2\left(q_{1} q_{3}+q_{0} q_{2}\right)} & {2\left(q_{2} q_{3}-q_{0} q_{1}\right)} & {q_{0}^{2}-q_{1}^{2}-q_{2}^{2}+q_{3}^{2}}\end{array}\right]
</script> </div> <h4 id=quaternion-euler-angles>Quaternion -&gt; Euler angles</h4> <p>Rotation matrix, quaternion and Euler angles are three common ways to represent rotation. However, the rotation order must be specified first before you converse <strong>quaternion to Euler angles</strong> and <strong>rotation matrix to Euler angles</strong>. This product uses the "ZYX" rotation sequence which rotates heading angle first, and then the pitch angle, and the last is roll angle.</p> <p>Formula :</p> <div> <div class=MathJax_Preview> \left[\begin{array}{c}{\phi}(Roll) \\ {\theta}(Pitch) \\ {\psi}(Heading)\end{array}\right] = \left[\begin{array}{c}{\operatorname{atan} 2\left(2 q_{2} q_{3}+2 q_{0} q_{1}, {q_{3}^{2}-q_{2}^{2}-q_{1}^{2}+q_{0}^{2} )}\right.} \\ {-\operatorname{asin}\left(2 q_{1} q_{3}-2 q_{0} q_{2}\right)} \\ {\operatorname{atan} 2\left(2 q_{1} q_{2}+2 q_{0} q_{3}\right)} , {q_{1}^{2}+q_{0}^{2}-q_{3}^{2}-q_{2}^{2} )}\end{array}\right] </div> <script type="math/tex; mode=display">
\left[\begin{array}{c}{\phi}(Roll) \\ {\theta}(Pitch) \\ {\psi}(Heading)\end{array}\right] = \left[\begin{array}{c}{\operatorname{atan} 2\left(2 q_{2} q_{3}+2 q_{0} q_{1},  {q_{3}^{2}-q_{2}^{2}-q_{1}^{2}+q_{0}^{2} )}\right.} \\ {-\operatorname{asin}\left(2 q_{1} q_{3}-2 q_{0} q_{2}\right)} \\ {\operatorname{atan} 2\left(2 q_{1} q_{2}+2 q_{0} q_{3}\right)} , {q_{1}^{2}+q_{0}^{2}-q_{3}^{2}-q_{2}^{2} )}\end{array}\right]
</script> </div> <h4 id=euler-angles-quaternion>Euler angles -&gt; Quaternion</h4> <p>From <span><span class=MathJax_Preview>s_{\phi}= \sin \frac{\phi}{2}, c_{\phi}= \cos \frac{\phi}{2}</span><script type=math/tex>s_{\phi}= \sin \frac{\phi}{2}, c_{\phi}= \cos \frac{\phi}{2}</script></span>, we got：</p> <div> <div class=MathJax_Preview> \mathbf{q}=\left[\begin{array}{c}{c_{\phi / 2} c_{\theta / 2} c_{\psi / 2}+s_{\phi / 2} s_{\theta / 2} s_{\psi / 2}} \\ {-c_{\phi / 2} s_{\theta / 2} s_{\psi / 2}+c_{\theta / 2} c_{\psi / 2} s_{\phi / 2}} \\ {c_{\phi / 2} c_{\psi / 2} s_{\theta / 2}+s_{\phi / 2} c_{\theta / 2} s_{\psi / 2}} \\ {c_{\phi / 2} c_{\theta / 2} s_{\psi / 2}-s_{\phi / 2} c_{\psi / 2} s_{\theta / 2}}\end{array}\right] </div> <script type="math/tex; mode=display">
\mathbf{q}=\left[\begin{array}{c}{c_{\phi / 2} c_{\theta / 2} c_{\psi / 2}+s_{\phi / 2} s_{\theta / 2} s_{\psi / 2}} \\ {-c_{\phi / 2} s_{\theta / 2} s_{\psi / 2}+c_{\theta / 2} c_{\psi / 2} s_{\phi / 2}} \\ {c_{\phi / 2} c_{\psi / 2} s_{\theta / 2}+s_{\phi / 2} c_{\theta / 2} s_{\psi / 2}} \\ {c_{\phi / 2} c_{\theta / 2} s_{\psi / 2}-s_{\phi / 2} c_{\psi / 2} s_{\theta / 2}}\end{array}\right]
</script> </div> <h4 id=euler-angles-rotation-matrix-n-b>Euler angles -&gt; Rotation matrix (n-&gt;b)</h4> <div> <div class=MathJax_Preview> R^{b}_{n} = \left[\begin{array}{ccc}{c_{\theta} c_{\psi}} &amp; {c_{\theta} s_{\psi}} &amp; {-s_{\theta}} \\ {s_{\phi} s_{\theta} c_{\psi}-c_{\phi} s_{\psi}} &amp; {s_{\phi} s_{\theta} s_{\psi}+c_{\phi} c_{\psi}} &amp; {c_{\theta} s_{\phi}} \\ {c_{\phi} s_{\theta} c_{\psi}+s_{\phi} s_{\psi}} &amp; {c_{\phi} s_{\theta} s_{\psi}-s_{\phi} c_{\psi}} &amp; {c_{\theta} c_{\phi}}\end{array}\right] </div> <script type="math/tex; mode=display">
R^{b}_{n} = \left[\begin{array}{ccc}{c_{\theta} c_{\psi}} & {c_{\theta} s_{\psi}} & {-s_{\theta}} \\ {s_{\phi} s_{\theta} c_{\psi}-c_{\phi} s_{\psi}} & {s_{\phi} s_{\theta} s_{\psi}+c_{\phi} c_{\psi}} & {c_{\theta} s_{\phi}} \\ {c_{\phi} s_{\theta} c_{\psi}+s_{\phi} s_{\psi}} & {c_{\phi} s_{\theta} s_{\psi}-s_{\phi} c_{\psi}} & {c_{\theta} c_{\phi}}\end{array}\right]
</script> </div> <h4 id=rotation-matrix-n-b-euler-angles>Rotation matrix (n-&gt;b) -&gt; Euler angles</h4> <div> <div class=MathJax_Preview> \left[\begin{array}{c}{\phi} \\ {\theta} \\ {\psi}\end{array}\right]=\left[\begin{array}{c}{\operatorname{atan} 2\left(r_{23}, r_{33}\right)} \\ {-\operatorname{asin}\left(r_{13}\right)} \\ {\operatorname{atan} 2\left(r_{12}, r_{11}\right)}\end{array}\right] </div> <script type="math/tex; mode=display">
\left[\begin{array}{c}{\phi} \\ {\theta} \\ {\psi}\end{array}\right]=\left[\begin{array}{c}{\operatorname{atan} 2\left(r_{23}, r_{33}\right)} \\ {-\operatorname{asin}\left(r_{13}\right)} \\ {\operatorname{atan} 2\left(r_{12}, r_{11}\right)}\end{array}\right]
</script> </div> <h2 id=appendix-c-firmware-upgrade-and-factory-reset>Appendix C - Firmware Upgrade and Factory Reset</h2> <p>This product supports online firmware upgrade. Please pay attention to the official website of Supercore Electronics <a href=http://www.hipnuc.com>www.hipnuc.com</a> for the latest firmware. Firmware upgrade steps:</p> <ul> <li>Get the latest firmware file. The extension of the file is (.hex).</li> <li>Connect the module, and run "Uranus". Switch to the firmware upgrade window, and set Baud (Baudrate) to 115200. </li> <li>Click "connect" button. If the module information shows successfully, meaning that the system is ready to upgrade. </li> <li>Now you can click the file selector (…), and select the firmware with the extension xxx.hex and click to start programming. After the download is completed, there will be a successful notification.</li> <li>Close the serial port and restart the module. Now it's upgraded.</li> </ul> <p><img alt src=../common_figures/firmware_update.png></p> </article> </div> </div> </main> </div> <script src=../../assets/javascripts/application.808e90bb.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> <script src=../../extra.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>